<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.gg.gop.dao.MatchDao">
	<select id="getMatchData">
SELECT
    championName, teamPosition,
    COUNT(CASE WHEN win = 'true' THEN 1 END) AS win_count,
    COUNT(*) AS total_count,
    round((COUNT(CASE WHEN win = 'true' THEN 1 END) / COUNT(*)*100),2) AS win_ratio	
FROM
    lol_datas
WHERE
    gameId IN (
        SELECT gameId
        FROM lol_datas
        WHERE championName = #{championName} and teamPosition=#{champteamPosition}
    )
    AND championName != #{championName}
    AND teamPosition !=#{champteamPosition}
    AND teamPosition =#{myteamPosition}
GROUP BY championName, teamPosition
order by total_count desc, win_ratio desc
limit 10;

	</select>
</mapper>